<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cotizador Moderno - SUBE IA</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    .header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 30px;
      border-bottom: 3px solid #00B8D9;
    }
    .header h1 {
      background: linear-gradient(135deg, #00B8D9, #FF4EFF);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 2.5em;
      margin: 0;
    }
    .form-group {
      margin-bottom: 25px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
      font-size: 14px;
    }
    input, select, textarea {
      width: 100%;
      padding: 15px;
      border: 2px solid #e1e5e9;
      border-radius: 10px;
      box-sizing: border-box;
      font-size: 14px;
      transition: all 0.3s ease;
      background: #f8f9fa;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #00B8D9;
      background: white;
      box-shadow: 0 0 0 3px rgba(0, 184, 217, 0.1);
    }
    .btn {
      background: linear-gradient(135deg, #00B8D9, #FF4EFF);
      color: white;
      border: none;
      padding: 18px 40px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      width: 100%;
      margin-top: 30px;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    .btn:active {
      transform: translateY(-1px);
    }
    .result {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 15px;
      margin: 20px 0;
      font-family: 'Courier New', monospace;
      white-space: pre-wrap;
      border-left: 4px solid #00B8D9;
    }
    .success { background: #d4edda; color: #155724; border-left-color: #28a745; }
    .error { color: #721c24; border-left-color: #dc3545; }
    
    /* Modal de previsualizaci√≥n */
    .modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.9);
      backdrop-filter: blur(5px);
    }
    .modal-content {
      background-color: white;
      margin: 2% auto;
      padding: 30px;
      border-radius: 20px;
      width: 95%;
      max-width: 900px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #e1e5e9;
    }
    .modal-title {
      font-size: 28px;
      font-weight: bold;
      background: linear-gradient(135deg, #00B8D9, #FF4EFF);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .close {
      color: #aaa;
      font-size: 35px;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    .close:hover {
      color: #00B8D9;
    }
    .preview-content {
      background: white;
      padding: 30px;
      border: 2px solid #e1e5e9;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    .modal-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
    }
    .modal-buttons .btn {
      width: auto;
      margin: 0;
      padding: 15px 30px;
    }
    .btn-secondary {
      background: linear-gradient(135deg, #6c757d, #495057);
    }
    .btn-success {
      background: linear-gradient(135deg, #28a745, #20c997);
    }
    .btn-print {
      background: linear-gradient(135deg, #17a2b8, #00B8D9);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìÑ Cotizador Moderno - SUBE IA TECH</h1>
      <p>Dise√±o profesional con previsualizaci√≥n avanzada</p>
    </div>
    
    <form id="cotizador-form">
      <div class="form-group">
        <label for="nombre">Nombre completo *</label>
        <input type="text" id="nombre" required value="Cliente Test">
      </div>
      
      <div class="form-group">
        <label for="email">Email *</label>
        <input type="email" id="email" required value="test@example.com">
      </div>
      
      <div class="form-group">
        <label for="empresa">Empresa *</label>
        <input type="text" id="empresa" required value="Empresa Test SPA">
      </div>
      
      <div class="form-group">
        <label for="servicio">Servicio *</label>
        <select id="servicio" required>
          <option value="Charlas">üé§ Charlas - Presentaciones orales</option>
          <option value="Capacitaciones">üéì Capacitaciones - Talleres pr√°cticos</option>
          <option value="Consultor√≠as">üíº Consultor√≠as - Diagn√≥stico y plan de acci√≥n</option>
          <option value="Certificaciones">üèÜ Certificaciones - Programas con diploma</option>
          <option value="Mentor√≠as">üë®‚Äçüè´ Mentor√≠as - Acompa√±amiento a largo plazo</option>
          <option value="Asesor√≠as de IA">ü§ñ Asesor√≠as de IA - Soporte en proyectos</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="detalle">Detalle del servicio *</label>
        <textarea id="detalle" rows="4" required placeholder="Describe detalladamente el servicio que necesitas...">Presentaci√≥n sobre Inteligencia Artificial para el equipo de desarrollo, incluyendo casos de uso pr√°cticos y mejores pr√°cticas de implementaci√≥n.</textarea>
      </div>
      
      <div class="form-group">
        <label for="valor">Valor del servicio *</label>
        <input type="number" id="valor" min="0" step="0.01" required value="75000" placeholder="Ingresa el valor en pesos chilenos">
      </div>
      
      <div class="form-group">
        <label for="descuento">Descuento (%)</label>
        <input type="number" id="descuento" min="0" max="100" step="0.01" value="15" placeholder="Porcentaje de descuento si aplica">
      </div>
      
      <button type="submit" class="btn" id="generar-btn">
        üëÅÔ∏è Previsualizar Cotizaci√≥n
      </button>
    </form>
    
    <div id="result" class="result" style="display: none;"></div>
  </div>

  <!-- Modal de previsualizaci√≥n -->
  <div id="previewModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="modal-title">üìã Previsualizaci√≥n de Cotizaci√≥n</span>
        <span class="close" onclick="cerrarModal()">&times;</span>
      </div>
      <div id="previewContent" class="preview-content">
        <!-- Aqu√≠ se mostrar√° la previsualizaci√≥n -->
      </div>
      <div class="modal-buttons">
        <button class="btn btn-secondary" onclick="cerrarModal()">‚ùå Cancelar</button>
        <button class="btn btn-print" onclick="abrirPaginaImpresion()">üñ®Ô∏è Imprimir PDF</button>
      </div>
    </div>
  </div>

  <script>
    let datosCotizacionActual = null;

    // Funci√≥n para mostrar resultado
    function mostrarResultado(mensaje, tipo = 'info') {
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = mensaje;
      resultDiv.className = `result ${tipo}`;
      resultDiv.style.display = 'block';
    }

    // Funci√≥n para generar c√≥digo √∫nico
    function generarCodigo() {
      const timestamp = Date.now();
      return `SUBEIA-${String(timestamp).slice(-6)}`;
    }

    // Funci√≥n para crear HTML de la cotizaci√≥n (dise√±o moderno)
    function crearHTMLCotizacion(datos) {
      return `
        <div style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: white; color: #333; padding: 40px; max-width: 800px; margin: 0 auto; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
          <!-- Header con logo -->
          <div style="text-align: center; margin-bottom: 40px; padding-bottom: 30px; border-bottom: 3px solid #00B8D9;">
            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
              <img src="assets/logo-blanco.png" alt="SUBE IA TECH" style="height: 60px; margin-right: 20px;">
              <div>
                <h1 style="color: #00B8D9; margin: 0; font-size: 32px; font-weight: 700;">SUBE IA TECH</h1>
                <p style="color: #666; margin: 5px 0; font-size: 14px;">Soluciones de Inteligencia Artificial</p>
              </div>
            </div>
            <h2 style="color: #333; margin: 15px 0; font-size: 24px; font-weight: 600;">Cotizaci√≥n de Servicios</h2>
            <div style="background: linear-gradient(135deg, #00B8D9, #FF4EFF); padding: 15px; border-radius: 10px; color: white; margin-top: 20px;">
              <p style="margin: 5px 0; font-size: 14px;">üìç Fco. Mansilla 1007, Castro, Chile</p>
              <p style="margin: 5px 0; font-size: 14px;">üìß contacto@subeia.tech | üÜî RUT: 77.994.591-K</p>
            </div>
          </div>
          
          <!-- Informaci√≥n del cliente y cotizaci√≥n -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 40px;">
            <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; border-left: 4px solid #00B8D9;">
              <h3 style="color: #333; margin: 0 0 15px 0; font-size: 18px; font-weight: 600;">üë§ Datos del Cliente</h3>
              <p style="margin: 8px 0; font-size: 14px;"><strong>Nombre:</strong> ${datos.nombre}</p>
              <p style="margin: 8px 0; font-size: 14px;"><strong>Email:</strong> ${datos.email}</p>
              <p style="margin: 8px 0; font-size: 14px;"><strong>Empresa:</strong> ${datos.empresa}</p>
            </div>
            <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; border-left: 4px solid #FF4EFF;">
              <h3 style="color: #333; margin: 0 0 15px 0; font-size: 18px; font-weight: 600;">üìã Informaci√≥n de Cotizaci√≥n</h3>
              <p style="margin: 8px 0; font-size: 14px;"><strong>Fecha:</strong> ${datos.fecha}</p>
              <p style="margin: 8px 0; font-size: 14px;"><strong>C√≥digo:</strong> ${datos.codigo}</p>
              <p style="margin: 8px 0; font-size: 14px;"><strong>Moneda:</strong> ${datos.moneda}</p>
            </div>
          </div>
          
          <!-- Servicios -->
          <div style="margin-bottom: 40px;">
            <h3 style="color: #333; border-bottom: 2px solid #e1e5e9; padding-bottom: 15px; font-size: 20px; font-weight: 600; margin-bottom: 25px;">üõ†Ô∏è Servicios Cotizados</h3>
            <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 25px; border-radius: 15px; border: 2px solid #e1e5e9;">
              <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <div style="background: #00B8D9; color: white; padding: 10px; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                  <span style="font-size: 18px;">üíº</span>
                </div>
                <h4 style="color: #00B8D9; margin: 0; font-size: 18px; font-weight: 600;">${datos.servicio}</h4>
              </div>
              <p style="margin: 10px 0; font-size: 14px; line-height: 1.6;"><strong>Detalle:</strong> ${datos.detalle}</p>
              <div style="background: white; padding: 15px; border-radius: 10px; margin-top: 15px;">
                <p style="margin: 0; font-weight: bold; color: #1976d2; font-size: 16px;">üí∞ Subtotal: ${datos.valor.toLocaleString()} ${datos.moneda}</p>
              </div>
            </div>
          </div>
          
          <!-- Totales -->
          <div style="background: linear-gradient(135deg, #00B8D9, #FF4EFF); padding: 30px; border-radius: 15px; color: white; margin-bottom: 30px;">
            <div style="text-align: right;">
              <h3 style="margin: 0 0 10px 0; font-size: 18px; font-weight: 600;">Subtotal: ${datos.valor.toLocaleString()} ${datos.moneda}</h3>
              ${datos.descuento > 0 ? `<h4 style="margin: 10px 0; font-size: 16px; font-weight: 600; color: #FFD700;">üéâ Descuento (${datos.descuento}%): -${datos.descuentoValor.toLocaleString()} ${datos.moneda}</h4>` : ''}
              <h2 style="margin: 15px 0 0 0; font-size: 28px; font-weight: 700;">Total: ${datos.totalConDescuento.toLocaleString()} ${datos.moneda}</h2>
            </div>
          </div>
          
          <!-- Footer -->
          <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; text-align: center; border-top: 3px solid #00B8D9;">
            <p style="margin: 5px 0; font-size: 12px; color: #666;"><strong>‚è∞ V√°lido 15 d√≠as</strong></p>
            <p style="margin: 5px 0; font-size: 12px; color: #666;">üí≥ Condiciones de pago: 50% al aceptar, 50% contra entrega</p>
            <p style="margin: 5px 0; font-size: 12px; color: #666;">üìû Consultas: contacto@subeia.tech</p>
            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e1e5e9;">
              <p style="margin: 0; font-size: 10px; color: #999;">SUBE IA TECH - Transformando el futuro con Inteligencia Artificial</p>
            </div>
          </div>
        </div>
      `;
    }

    // Funci√≥n para mostrar previsualizaci√≥n
    function mostrarPrevisualizacion(datos) {
      const modal = document.getElementById('previewModal');
      const previewContent = document.getElementById('previewContent');
      
      // Crear el HTML de la cotizaci√≥n
      const html = crearHTMLCotizacion(datos);
      previewContent.innerHTML = html;
      
      // Mostrar el modal
      modal.style.display = 'block';
      
      // Guardar los datos para usar en la generaci√≥n del PDF
      datosCotizacionActual = datos;
    }

    // Funci√≥n para cerrar modal
    function cerrarModal() {
      const modal = document.getElementById('previewModal');
      modal.style.display = 'none';
    }

    // Funci√≥n para abrir p√°gina de impresi√≥n
    function abrirPaginaImpresion() {
      if (!datosCotizacionActual) {
        mostrarResultado('‚ùå No hay datos de cotizaci√≥n para imprimir', 'error');
        return;
      }

      // Crear una nueva ventana con la cotizaci√≥n
      const html = crearHTMLCotizacion(datosCotizacionActual);
      const printWindow = window.open('', '_blank');
      printWindow.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Cotizaci√≥n ${datosCotizacionActual.codigo} - SUBE IA TECH</title>
          <style>
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
            }
            body {
              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
              margin: 0;
              padding: 20px;
              background: white;
            }
            .print-header {
              text-align: center;
              margin-bottom: 20px;
              padding: 20px;
              background: #f8f9fa;
              border-radius: 10px;
            }
            .print-button {
              background: #00B8D9;
              color: white;
              border: none;
              padding: 15px 30px;
              border-radius: 10px;
              cursor: pointer;
              font-size: 16px;
              margin: 20px;
            }
          </style>
        </head>
        <body>
          <div class="print-header no-print">
            <h2>üìÑ Cotizaci√≥n ${datosCotizacionActual.codigo}</h2>
            <p>Esta p√°gina est√° optimizada para impresi√≥n. Usa Ctrl+P para imprimir o guardar como PDF.</p>
            <button class="print-button" onclick="window.print()">üñ®Ô∏è Imprimir / Guardar PDF</button>
            <button class="print-button" onclick="window.close()">‚ùå Cerrar</button>
          </div>
          ${html}
        </body>
        </html>
      `);
      printWindow.document.close();
      
      cerrarModal();
      mostrarResultado(`‚úÖ P√°gina de impresi√≥n abierta para: ${datosCotizacionActual.codigo}`, 'success');
    }

    // Funci√≥n principal para procesar el formulario
    function procesarCotizacion(event) {
      event.preventDefault();
      console.log('Procesando cotizaci√≥n...');
      
      const btn = document.getElementById('generar-btn');
      btn.disabled = true;
      btn.textContent = '‚è≥ Procesando...';
      
      try {
        // Recopilar datos del formulario
        const nombre = document.getElementById('nombre').value.trim();
        const email = document.getElementById('email').value.trim();
        const empresa = document.getElementById('empresa').value.trim();
        const servicio = document.getElementById('servicio').value;
        const detalle = document.getElementById('detalle').value.trim();
        const valor = parseFloat(document.getElementById('valor').value || '0');
        const descuento = parseFloat(document.getElementById('descuento').value || '0');
        
        console.log('Datos recopilados:', { nombre, email, empresa, servicio, detalle, valor, descuento });
        
        // Validar campos requeridos
        if (!nombre || !email || !empresa || !servicio || !detalle || valor <= 0) {
          throw new Error('Por favor, completa todos los campos requeridos con valores v√°lidos.');
        }
        
        // Calcular descuento
        const descuentoValor = valor * (descuento / 100);
        const totalConDescuento = valor - descuentoValor;
        
        // Crear objeto de datos
        const datosCotizacion = {
          codigo: generarCodigo(),
          nombre,
          email,
          empresa,
          servicio,
          detalle,
          valor,
          descuento,
          descuentoValor,
          totalConDescuento,
          moneda: 'CLP',
          fecha: new Date().toLocaleDateString('es-CL')
        };
        
        console.log('Datos de cotizaci√≥n:', datosCotizacion);
        mostrarResultado('‚úÖ Datos validados correctamente', 'success');
        
        // Mostrar previsualizaci√≥n
        setTimeout(() => {
          mostrarPrevisualizacion(datosCotizacion);
        }, 500);
        
      } catch (error) {
        console.error('Error en procesamiento:', error);
        mostrarResultado(`‚ùå Error: ${error.message}`, 'error');
      } finally {
        btn.disabled = false;
        btn.textContent = 'üëÅÔ∏è Previsualizar Cotizaci√≥n';
      }
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM cargado, configurando event listeners...');
      
      // Event listener para el formulario del cotizador
      const form = document.getElementById('cotizador-form');
      if (form) {
        form.addEventListener('submit', procesarCotizacion);
        console.log('Event listener del formulario configurado');
      } else {
        console.error('Formulario no encontrado');
      }
      
      console.log('‚úÖ Cotizador moderno inicializado');
    });

    // Cerrar modal al hacer clic fuera de √©l
    window.onclick = function(event) {
      const modal = document.getElementById('previewModal');
      if (event.target === modal) {
        cerrarModal();
      }
    }
  </script>
</body>
</html> 